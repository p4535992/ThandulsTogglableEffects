{"name":"Toggle Invisible","permission":{"default":0,"gz5bbhiTO9Y5saZX":3},"type":"script","flags":{"core":{"sourceId":"Compendium.conditional-visibility.Conditional Visibility.qeE9JiWntRzjeBBr"}},"scope":"global","command":"//Toggles selected tokens invisible\nConditionalVisibility.toggleCondition(canvas.tokens.controlled, 'invisible', true)","author":"gz5bbhiTO9Y5saZX","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"0az3wKTK51zyacNr"}
{"name":"CUB-Exhausted","permission":{"default":0,"gz5bbhiTO9Y5saZX":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.giaQsPpn042N8GYh"}},"scope":"global","command":"// CUB-Exhausted macro\nif (args[0] == \"on\") {\n    var exNew = args[1].efData.label\n    const levels = [\"Exhaustion 1\",\"Exhaustion 2\",\"Exhaustion 3\",\"Exhaustion 4\",\"Exhaustion 5\"]\n    for(const ex of levels){\n        if ((ex != exNew) && (game.cub.hasCondition(ex))){\n            await game.cub.removeCondition(ex)\n        }\n    }\n}","author":"gz5bbhiTO9Y5saZX","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"0wwHQtiNHdANGTZD"}
{"name":"Toggle Hide (Stealth Roll)","permission":{"default":0,"gz5bbhiTO9Y5saZX":3},"type":"script","flags":{"core":{"sourceId":"Compendium.conditional-visibility.Conditional Visibility.xuE9JiWntQajeBBr"}},"scope":"global","command":"//Rolls stealth and hides tokens on systems that support it.  (Currently dnd5e only)\nConditionalVisibility.toggleHide(canvas.tokens.controlled)","author":"gz5bbhiTO9Y5saZX","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"8AvoKqoYLJ0Hjrva"}
{"name":"Toggle Obscured","permission":{"default":0,"gz5bbhiTO9Y5saZX":3},"type":"script","flags":{"core":{"sourceId":"Compendium.conditional-visibility.Conditional Visibility.ioE9JiWntRzjeBBr"}},"scope":"global","command":"//Toggles selected tokens obscured\nConditionalVisibility.toggleCondition(canvas.tokens.controlled, 'obscured', true)","author":"gz5bbhiTO9Y5saZX","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"Ay3JYwmdBObjmihd"}
{"name":"Attempt to Migrate Conditional Visiblity Foundry 0.6 to 0.7","permission":{"default":0,"gz5bbhiTO9Y5saZX":3},"type":"script","flags":{"core":{"sourceId":"Compendium.conditional-visibility.Conditional Visibility.pkA4JiWntARaeBBr"}},"scope":"global","command":"// Attempts to remove statusEffects set in Foundry 06 and applies the equivalent effect for Foundry 0.7\n\nlet update0607ConvisMatches = {\n\t'modules/conditional-visibility/icons/unknown.svg': 'invisible',\n\t'modules/conditional-visibility/icons/newspaper.svg': 'hiding',\n\t'modules/conditional-visibility/icons/foggy.svg': 'obscured',\n\t'modules/conditional-visibility/icons/moon.svg': 'indarkness'\n}\n\nconst popper = async function(token, effects) {\n\tawait effects.reduce(async (promise, eff) => {\n\t\tawait promise;\n\t\tif (eff.endsWith('newspaper.svg')) {\n\t\t\tconsole.info('Migrating 0.6->0.7 hiding for ' + token.data.name);\n\t\t\ttoken.data.effects.splice(token.data.effects.indexOf(eff), 1);\n\t\t\tconst ste = token.data?.flags['conditional-visibility']?._ste;\n\t\t\tif (ste) {\n\t\t\t\tawait ConditionalVisibility.hide([token], ste);\n\t\t\t} else {\n\t\t\t\tawait ConditionalVisibility.hide([token]);\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.info('Migrating 0.6->0.7 ' + update0607ConvisMatches[eff] + ' for ' + token.data.name);\n\t\t\ttoken.data.effects.splice(token.data.effects.indexOf(eff), 1);\n\t\t\tawait ConditionalVisibility.setCondition([token], update0607ConvisMatches[eff], true);\n\t\t}\n\t}, Promise.resolve());\n}\n\nfor (const token of canvas.tokens.placeables) {\n\tif (token.data.effects.length > 0) {\n\t\tconst name = token.data.name;\n\t\tconst effectsToToggle = token.data.effects.filter(eff => {\n\t\t\tlet toCheck;\n\t\t\tif (typeof eff === 'string') {\n\t\t\t\ttoCheck = eff;\n\t\t\t} else {\n\t\t\t\ttoCheck = eff.icon;\n\t\t\t}\n\t\t\treturn toCheck && update0607ConvisMatches[toCheck] !== undefined;\n\t\t});\n\t\tpopper(token, effectsToToggle);\n\t};\n}","author":"gz5bbhiTO9Y5saZX","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"HVWnYx1XxRdOjsYN"}
{"name":"Toggle Hide (Fixed Value)","permission":{"default":0,"gz5bbhiTO9Y5saZX":3},"type":"script","flags":{"core":{"sourceId":"Compendium.conditional-visibility.Conditional Visibility.avuE9JiWntVyjkABr"}},"scope":"global","command":"//Toggles hide using a fixed stealth value on selected tokens for systems that support it.  (Currently dnd5e only) (Currently dnd5e only)\nConditionalVisibility.toggleHide(canvas.tokens.controlled, prompt('Enter a stealth value for all selected tokens'))","author":"gz5bbhiTO9Y5saZX","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"PcvJ8eVBCJjRO3MS"}
{"name":"Toggle In Darkness","permission":{"default":0,"gz5bbhiTO9Y5saZX":3},"type":"script","flags":{"core":{"sourceId":"Compendium.conditional-visibility.Conditional Visibility.ioE9JiWntRzjeDFr"}},"scope":"global","command":"//Toggles selected tokens in darkness\nConditionalVisibility.toggleCondition(canvas.tokens.controlled, 'indarkness', true)","author":"gz5bbhiTO9Y5saZX","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"RtxGLyxgq8588JbQ"}
